{
    "name": "fa2-multi-token-mint-burn-events",
    "description": "Off-chain events for https://github.com/tqtezos/smart-contracts/tree/master/multi_asset/ligo",
    "version": "0.1.0",
    "license": {"name": "MIT", "details": "The MIT License"},
    "interfaces": ["TZIP-7", "TZIP-16", "TZIP-20"],
    "views": [
        {
            "name": "getChangedTokenBalances",
            "description": "Get token balance updates",
            "pure": "true",
            "implementations": [
                {
                    "michelson-parameter-view": {
                        "parameter": {
                            "prim": "or",
                            "args": [
                                {
                                    "prim": "list",
                                    "annots": ["%burn_tokens"],
                                    "args": [
                                        {
                                            "prim": "pair",
                                            "args": [
                                                {"prim": "address", "annots": ["%owner"]},
                                                {"prim": "pair", "args": [{"prim": "nat", "annots": ["%token_id"]}, {"prim": "nat", "annots": ["%amount"]}]}
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "prim": "list",
                                    "annots": ["%mint_tokens"],
                                    "args": [
                                        {
                                            "prim": "pair",
                                            "args": [
                                                {"prim": "address", "annots": ["%owner"]},
                                                {"prim": "pair", "args": [{"prim": "nat", "annots": ["%token_id"]}, {"prim": "nat", "annots": ["%amount"]}]}
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        "return-type": {"prim": "map", "args": [{"prim": "pair", "args": [{"prim": "address"}, {"prim": "nat"}]}, {"prim": "int"}]},
                        "code": [
                            {"prim": "DUP"},
                            {"prim": "CDR"},
                            {"prim": "SWAP"},
                            {"prim": "CAR"},
                            {
                                "prim": "IF_LEFT",
                                "args": [
                                    [
                                        {
                                            "prim": "ITER",
                                            "args": [
                                                [
                                                    {"prim": "SWAP"},
                                                    {"prim": "DUP"},
                                                    {"prim": "DIG", "args": [{"int": "2"}]},
                                                    {"prim": "DUP"},
                                                    {"prim": "DUG", "args": [{"int": "3"}]},
                                                    {"prim": "CDR"},
                                                    {"prim": "CAR"},
                                                    {"prim": "DIG", "args": [{"int": "3"}]},
                                                    {"prim": "DUP"},
                                                    {"prim": "DUG", "args": [{"int": "4"}]},
                                                    {"prim": "CAR"},
                                                    {"prim": "PAIR"},
                                                    {"prim": "GET"},
                                                    {
                                                        "prim": "IF_NONE",
                                                        "args": [
                                                            [
                                                                {"prim": "SWAP"},
                                                                {"prim": "DUP"},
                                                                {"prim": "DUG", "args": [{"int": "2"}]},
                                                                {"prim": "CDR"},
                                                                {"prim": "CDR"},
                                                                {"prim": "INT"},
                                                                {"prim": "NEG"}
                                                            ],
                                                            [
                                                                {"prim": "DIG", "args": [{"int": "2"}]},
                                                                {"prim": "DUP"},
                                                                {"prim": "DUG", "args": [{"int": "3"}]},
                                                                {"prim": "CDR"},
                                                                {"prim": "CDR"},
                                                                {"prim": "INT"},
                                                                {"prim": "SWAP"},
                                                                {"prim": "SUB"}
                                                            ]
                                                        ]
                                                    },
                                                    {"prim": "SOME"},
                                                    {"prim": "DIG", "args": [{"int": "2"}]},
                                                    {"prim": "DUP"},
                                                    {"prim": "DUG", "args": [{"int": "3"}]},
                                                    {"prim": "CDR"},
                                                    {"prim": "CAR"},
                                                    {"prim": "DIG", "args": [{"int": "3"}]},
                                                    {"prim": "CAR"},
                                                    {"prim": "PAIR"},
                                                    {"prim": "UPDATE"}
                                                ]
                                            ]
                                        }
                                    ],
                                    [
                                        {
                                            "prim": "ITER",
                                            "args": [
                                                [
                                                    {"prim": "SWAP"},
                                                    {"prim": "DUP"},
                                                    {"prim": "DIG", "args": [{"int": "2"}]},
                                                    {"prim": "DUP"},
                                                    {"prim": "DUG", "args": [{"int": "3"}]},
                                                    {"prim": "CDR"},
                                                    {"prim": "CAR"},
                                                    {"prim": "DIG", "args": [{"int": "3"}]},
                                                    {"prim": "DUP"},
                                                    {"prim": "DUG", "args": [{"int": "4"}]},
                                                    {"prim": "CAR"},
                                                    {"prim": "PAIR"},
                                                    {"prim": "GET"},
                                                    {
                                                        "prim": "IF_NONE",
                                                        "args": [
                                                            [{"prim": "SWAP"}, {"prim": "DUP"}, {"prim": "DUG", "args": [{"int": "2"}]}, {"prim": "CDR"}, {"prim": "CDR"}, {"prim": "INT"}],
                                                            [
                                                                {"prim": "DIG", "args": [{"int": "2"}]},
                                                                {"prim": "DUP"},
                                                                {"prim": "DUG", "args": [{"int": "3"}]},
                                                                {"prim": "CDR"},
                                                                {"prim": "CDR"},
                                                                {"prim": "INT"},
                                                                {"prim": "ADD"}
                                                            ]
                                                        ]
                                                    },
                                                    {"prim": "SOME"},
                                                    {"prim": "DIG", "args": [{"int": "2"}]},
                                                    {"prim": "DUP"},
                                                    {"prim": "DUG", "args": [{"int": "3"}]},
                                                    {"prim": "CDR"},
                                                    {"prim": "CAR"},
                                                    {"prim": "DIG", "args": [{"int": "3"}]},
                                                    {"prim": "CAR"},
                                                    {"prim": "PAIR"},
                                                    {"prim": "UPDATE"}
                                                ]
                                            ]
                                        }
                                    ]
                                ]
                            },
                            {"prim": "NIL", "args": [{"prim": "operation"}]},
                            {"prim": "PAIR"}
                        ],
                        "entrypoints": ["mint_tokens", "burn_tokens"]
                    }
                }
            ]
        }
    ]
}